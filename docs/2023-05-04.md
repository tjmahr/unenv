<!--- Timestamp to trigger book rebuilds: 2023-05-04 15:07:31.616748 --->



## May 2023

<small>Source: <code>2023-05-04.Rmd</code></small>


### Nonlinear model zoo

#### Gompertz 

The [Gompertz function](https://en.wikipedia.org/wiki/Gompertz_function)
"describes growth as being slowest at the start and end of a given time
period. The right-side or future value asymptote of the function is
approached much more gradually by the curve than the left-side or lower
valued asymptote." 

$$
f(t) = a\mathrm{e}^{-b\mathrm{e}^{-ct}} \\
a: \textrm{asymptote} \\
b: \textrm{translation left or right} \\
c: \textrm{growth factor} \\
$$

So we have two different growth rates but a single parameter relating to
growth rate. R's implementation (`stats::SSgompertz()`) "simplifies" the
double exponential into `Asym * exp(-b2 * b3 ^ x)`.

The scaling factor c or b3 makes sense in the original Gompertz
equation. I couldn't understand what the R version was doing because it was
changing the base of exponentiation.


```r
gompertz <- function(xs, asym, b2, b3) {
  asym * exp(-b2 * exp(-b3 * xs))
}

ggplot() + 
  xlim(-10, 10) +
  stat_function(
    aes(color = "b3 = 1"),
    fun = gompertz, 
    args = list(asym = 1, b2 = 1, b3 = 1)
  ) + 
  stat_function(
    aes(color = "b3 = .2"),
    fun = gompertz, 
    args = list(asym = 1, b2 = 1, b3 = .2)
  ) +
  stat_function(
    aes(color = "b3 = 0"),
    fun = gompertz, 
    args = list(asym = 1, b2 = 1, b3 = 0)
  ) +
  stat_function(
    aes(color = "b3 = -1"),
    fun = gompertz, 
    args = list(asym = 1, b2 = 1, b3 = -1)
  ) 
#> Error in ggplot(): could not find function "ggplot"
```

We have this weird thing where $b = 1/2$ and $b = 2$ are the same
distance from $b = 1$.



```r
ggplot() + 
  xlim(-10, 10) +
  stat_function(
    aes(color = "b2 = 1"),
    fun = gompertz, 
    args = list(asym = 1, b2 = 1, b3 = 1)
  ) +
  stat_function(
    aes(color = "b2 = .5"),
    fun = gompertz, 
    args = list(asym = 1, b2 = .5, b3 = 1)
  ) +
  stat_function(
    aes(color = "b2 = .1"),
    fun = gompertz, 
    args = list(asym = 1, b2 = .1, b3 = 1)
  ) +
  stat_function(
    aes(color = "b2 = 0"),
    fun = gompertz, 
    args = list(asym = 1, b2 = 0, b3 = 1)
  ) +
  stat_function(
    aes(color = "b2 = 2"),
    fun = gompertz, 
    args = list(asym = 1, b2 = 2, b3 = 1)
  ) 
#> Error in ggplot(): could not find function "ggplot"
```




